<h1>Jeedom Plugin pour Devices/Stations Eufy</h1>

<p><img src="../images/jeedom.png" alt="Logo Jeedom" title="" />
<img src="../images/eufy.png" alt="Logo Plugin" title="" /></p>

<h2>Documentation</h2>

<ul>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#synchronisation">Synchronisation</a></li>
<li><a href="#health">Santé</a></li>
<li><a href="#equipments">Equipements</a></li>
<li><a href="#troubleshooting">Bugs et dépannage</a></li>
</ul>

<h3>Configuration</h3>

<p><img src="../images/eufy3.png" alt="Configuration" title="" /></p>

<p>Installer le plugin et ses dépendances.
<br>Note: L'installation des dépendances n'installe PAS l'image <code>eufy-security-ws</code>.
<br>Vous avez le choix entre les modes local et distant pour docker:</p>

<h4>1. Mode local</h4>

<p>L'installation du mode local a pour prérequis docker déjà installé et configuré.
<br>Si ce n'est pas le cas installer le plugin officiel docker management ou en ligne de commande:</p>

<p><code>$ apt-get install docker.io</code></p>

<p>Configuration post-installation:</p>

<ul>
<li>Installer/désinstaller Eufy: installer/désinstaller l'image <code>eufy-security-ws</code></li>
<li>Démarrer/arrêter Eufy: démarrer/arrêter le container <code>eufy-security-ws</code></li>
<li>Device: paramètre Eufy-WS <code>TRUSTED_DEVICE_NAME</code> utilisé pour se connecter au serveur Cloud Eufy</li>
<li>User/password: identifiants du service Cloud <code>Eufy-WS</code></li>
</ul>

<h4>2. Mode distant (expert)</h4>

<p>Le container <code>eufy-security-ws</code> doit déjà être installé sur un docker distant.
<br>Vous pouvez copier et utiliser le script <code>resources/eufyctl.sh</code> pour installer et tester manuellement l'image <code>eufy-security-ws</code> sur un serveur distant:</p>

<p><code>eufyctl.sh install|uninstall|status|test|stop|start &lt;device&gt; &lt;login&gt; &lt;passwd&gt; [ port ]</code></p>

<h4>3. Paramètres communs</h4>

<ul>
<li>IP Docker: adresse IP du container <code>eufy-security-ws</code>, 127.0.0.1 par défaut</li>
<li>Port Docker: port du container <code>eufy-security-ws</code>, 3000 par défaut</li>
<li>Tester: Vérifier la présence du container <code>eufy-security-ws</code> et sa connexion au service Cloud Eufy</li>
</ul>

<p>Notes: 
- Le daemon Eufy ne démarrera pas si le container <code>eufy-security-ws</code> ne peut pas se connecter au service Cloud Eufy
- La version du container est indiquée dans le champ <code>Version</code></p>

<h4>4. Soucis de connexion</h4>

<p>En cas de problème vérifier la connexion avec le container via la commande suivante:
<br><code>resources/eufyctl.sh test</code>
<br>
<br> Vous devriez obtenir l'output suivant:</p>

<p><code>
{"type":"result","success":true,"result":{"state":{"driver":{"version":"2.4.0","connected":true,"pushConnected":true}
</code></p>

<p>Note: <code>connected</code> et <code>pushConnected</code> doivent être à <code>true</code>
<br>Voir également la log <code>eufy_service_setup</code> </p>

<h3>Synchronisation</h3>

<p><img src="../images/eufy2.png" alt="Configuration" title="" /></p>

<p>Note: pour l'instant seuls certains modèles ont été testés. Si votre modèle n'est pas suporté vous pouvez m'envoyer le résutat de la commande <code>resources/test_eufy.py</code>
<br> Voir <a href="../../README.html#Tested">ici</a> pour plus d'infos.</p>

<h3>Santé</h3>

<p><img src="../images/eufy1.png" alt="Configuration" title="" /></p>

<p>Liste et statut des devices reconnus </p>

<h3>Equipements</h3>

<p><img src="../images/eufy4.png" alt="Equipments" title="" />
<img src="../images/eufy5.png" alt="Equipments" title="" />
<img src="../images/eufy6.png" alt="Equipments" title="" /></p>

<h3>Snapshots</h3>

<p>La commande <code>URL snaphot</code> contient l'URL de l'image sur le serveur
<br> Vous pouvez utiliser mon widget <a href="https://github.com/lxrootard/widgets_v4">ImageViewer</a>
<br> Pensez à activer les notifications d'image dans les paramètres de vos devices depuis l'application Eufy sans quoi les snapshots ne seront pas mis à jour</p>

<h3>Video stream RTSP</h3>

<p>Le flux RTSP fonctionne dans le plugin <a href="https://doc.jeedom.com/fr_FR/plugins/security/camera">Camera</a>
<br>Sur les caméras à batterie il doit être activé/désactivé via les commandes de l'équipement.
<br>L'IP est celle de la base et <code>live0..liven</code> indiquent le numéro de la caméra, cf ce screenshot:</p>

<p><img src="../images/camera_plugin.jpg" alt="Video stream RTSP" title="" /></p>

<p><br>Voir <a href="https://camlytics.com/camera/eufy">ici</a> selon votre modèle</p>

<h3>Bugs et dépannage</h3>

<p>Voir <a href="../../README.html#Troubleshooting">ici</a></p>
